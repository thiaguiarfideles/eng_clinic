<!DOCTYPE html>

<html>
  <head>
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script type = "text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script type = "text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script type = "text/javascript"  src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <!-- Datatable -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.1/css/dataTables.bulma.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/rowgroup/1.3.0/css/rowGroup.bulma.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/searchpanes/2.0.2/css/searchPanes.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/select/1.4.0/css/select.dataTables.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/1.13.1/js/dataTables.bulma.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/rowgroup/1.3.0/js/dataTables.rowGroup.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/plug-ins/1.10.15/dataRender/datetime.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/searchpanes/2.0.2/js/dataTables.searchPanes.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/select/1.4.0/js/dataTables.select.min.js"></script>


    <script type="text/javascript" class="init">



$(document).ready(function () {
    $('#tp_linha').DataTable({
        initComplete: function () {
            this.api()
                .columns()
                .every(function () {
                    var column = this;
                    var select = $('<select><option value="ESTABELECIMENTO"></option></select>')
                        .appendTo($(column.footer()).empty())
                        .on('change', function () {
                            var val = $.fn.dataTable.util.escapeRegex($(this).val());
 
                            column.search(val ? '^' + val + '$' : '', true, false).draw();
                        });
 
                    column
                        .data()
                        .unique()
                        .sort()
                        .each(function (d, j) {
                            select.append('<option value="' + d + '">' + d + '</option>');
                        });
                });
        },
    });
});



(function( factory ) {
    "use strict";

    if ( typeof define === 'function' && define.amd ) {
        // AMD
        define( ['jquery'], function ( $ ) {
            return factory( $, window, document );
        } );
    }
    else if ( typeof exports === 'object' ) {
        // CommonJS
        module.exports = function (root, $) {
            if ( ! root ) {
                root = window;
            }

            if ( ! $ ) {
                $ = typeof window !== 'undefined' ?
                    require('jquery') :
                    require('jquery')( root );
            }

            return factory( $, root, root.document );
        };
    }
    else {
        // Browser
        factory( jQuery, window, document );
    }
}
(function( $, window, document ) {


$.fn.dataTable.render.moment = function ( from, to, locale ) {
    // Argument shifting
    if ( arguments.length === 1 ) {
        locale = 'br';
        to = from;
        from = 'DD-MM-YYYY';
    }
    else if ( arguments.length === 2 ) {
        locale = 'br';
    }

    return function ( d, type, row ) {
        var m = window.moment( d, from, locale, true );

        // Order and type get a number value from Moment, everything else
        // sees the rendered value
        return m.format( type === 'sort' || type === 'type' ? 'x' : to );
    };
};


}));






function gettime() {
    var date= new Date();
    var hr = date.getHours();
    var m = date.getMinutes();
    var s = date.getSeconds();
    if(m < 12)
    {
        m = "0" + m
    }
    if(s < 12)
    {
        s = "0" + s
    }
    document.clockform.clock.value = hr + ":" + m + ":" + s;
    setTimeout("gettime()",100)
}

// date part ///
var month=x.getMonth()+1;
var day=x.getDate();
var year=x.getFullYear();
if (month <12 ){month='0' + month;}
if (day <30 ){day='0' + day;}
var x3= month+'-'+day+'-'+year;

// time part //
var hour=x.getHours();
var minute=x.getMinutes();
var second=x.getSeconds();
if(hour <24 ){hour='0'+hour;}
if(minute <10 ) {minute='0' + minute; }
if(second<10){second='0' + second;}
var x3 = x3 + ' ' +  hour+':'+minute+':'+second


</script>
<style>
p{
   font-size:12;
 }

p.normal {
  font-weight: normal;
}

p.light {
  font-weight: lighter;
}

p.thick {
  font-weight: bold;
}

p.thicker {
  font-weight: 900;
}
.lead {
    font-weight: bold;
  }
  #nav {
              display: flex;
              justify-content: center;
              align-items: center;
              background-color: #333;
              color: #fff;
              height: 50px;
            }
          
            #nav ul {
              display: flex;
              list-style: none;
              margin: 0;
              padding: 0;
            }
          
            #nav li {
              display: inline-block;
              margin-right: 10px;
            }
          
            #nav a {
              color: #fff;
              text-decoration: none;
              padding: 10px 15px;
            }
          
            #nav a:hover {
              background-color: #444;
            }
</style>

<nav id="nav" role="navigation">
  <ul id="menu-menu-1">
    <!-- outros itens de menu -->
    <li class="menu-inline menu-item">
      <a title="Produtos" href="/TP_DASH" target="_blank">Média de tempo integração Barras</a>
        <i class="a-solid fa-circle-plus fa-beat" aria-hidden="true"></i>
      </a>
    </li>
    <li class="menu-inline menu-item">
      <a title="Produtos" href="/TP_PIZZA" target="_blank">Quantidade de exames integrados Pizza</a>
        <i class="a-solid fa-circle-plus fa-beat" aria-hidden="true"></i>
      </a>
    </li>
    <li class="menu-inline menu-item">
      <a title="Produtos" href="/TP_TABELA" target="_blank">Tabela QNT | Prescr | Média Tempo</a>
        <i class="a-solid fa-circle-plus fa-beat" aria-hidden="true"></i>
      </a>
    </li>
    <li class="menu-inline menu-item">
      <a title="Produtos" href="/TEMPO_INTEGRA" target="_blank">Visualizar não integrados</a>
        <i class="a-solid fa-circle-plus fa-beat" aria-hidden="true"></i>
      </a>
    </li>
    
  </ul>
</nav>
</head>



{% block content %}
</html>

<div class="jumbotron text-center">
    <h4 class="display-4">Tempo de integração dos Pedidos</h4>
    <p class="lead" font-weight: bold;>ESTABELECIMENTOS TASY|MATRIX</p>
    <p>Tempo de integração | Tempo do resultado</p>
    <p>CONSULTA NAS ULTIMAS 72 HORAS:</p>
    <span id="clock-display"></span>
    <span id="day-of-week"></span>
    <hr class="my-1">
    <button type="button" class="btn btn-warning" onClick="window.location.reload()">Atualizar Página</button>
</hr>

  </div>


     <div>
        <div class="card-body">
            <table id="tp_linha" class="display table-bordered" class="border=1" style=width: 100%>
  
        <thead>

            
            <tr>

              <th>DT_INTEGRACAO</th>
              <th>QNT_EXAMES</th>
              <th>QNT_PRESCR</th>
              <th>QTD_COM_RESULTADO</th>
              <th>QTD_SEM_RESULTADO</th>
              <th>AVG_TP_INTEGRA</th>
              <th>AVG_TP_RESULTADO</th>
              <th>PERCENT_COM_RESULTADO</th>
              <th>ESTABELECIMENTO</th>

            </tr>
        </thead>
        <tbody>

        {%for item in items[:6000] %}
            <tr>
              <td>{{item.DT_INTEGRACAO}}</td>
              <td><span style="color:rgb(13, 13, 13);font-weight:bold;">{{item.QNT_EXAMES}}</span></td>
              <td>{{item.QNT_PRESCR}}</td>
              <td>{{item.QTD_COM_RESULTADO}}</td>
              <td>{{item.QTD_SEM_RESULTADO}}</td>
              <td>{{item.AVG_TP_INTEGRA}}</td>
              <td colspan>{{item.AVG_TP_RESULTADO}}</td>
              <td>{{item.PERCENT_COM_RESULTADO}}</td>
              <td colspan>{{item.ESTABELECIMENTO}}</td>


            </tr>
        {%endfor%}
        </tbody>
</table>

</div>
</div>



 <script>
$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#tempo tbody tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});


</script>

<script>
    function gettime() {
      var currentTime = new Date();
      var hours = currentTime.getHours();
      var minutes = currentTime.getMinutes();
      var seconds = currentTime.getSeconds();
      if (minutes < 10) {
        minutes = "0" + minutes;
      }
      if (seconds < 10) {
        seconds = "0" + seconds;
      }
      document.getElementById("clock-display").innerHTML = hours + ":" + minutes + ":" + seconds;
      setTimeout("gettime()", 1000);
    }
    gettime();
  </script>
  <script>
    function getDayOfWeek() {
      var daysOfWeek = ["Domingo", "Segunda", "Terça", "Quarta", "Quinta", "Sexta", "Sábado"];
      var currentDate = new Date();
      var offset = -3; // GMT -3 horas para São Paulo
      var localTime = new Date(currentDate.getTime() + offset * 60 * 60 * 1000);
      var dayOfWeek = daysOfWeek[localTime.getUTCDay()];
      document.getElementById("day-of-week").innerHTML = "Hoje é " + dayOfWeek;
    }
    getDayOfWeek();
  </script>
  
{% endblock %}